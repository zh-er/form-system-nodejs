(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),s=n(21),c=n.n(s),a=(n(27),n(2)),i=(n(28),n(5)),d=n(10),l=n(14),u=n.n(l),j=n(3),b=n(17),m={apiUrl:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_BASE_URL||"/api"},f=m.apiUrl;function p(){return(p=Object(b.a)(u.a.mark((function e(t,n){var r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(f,"/report"),o={method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify(t)},e.abrupt("return",fetch(r,o).then((function(e){return e.json()})).then((function(e){return e.data})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t){var n="".concat(f,"/report/").concat(e.id),r={method:"PUT",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify(e)};return fetch(n,r).then((function(e){return e.json()})).then((function(e){return e.data}))}function x(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[1],o="".concat(f,"/report/"),s={method:"GET",headers:{Authorization:r}};return fetch(o,s).then((function(e){return e.json()})).then((function(e){return e.data.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{updatedAt:new Date(e.updatedAt)})}))}))}function g(){return O.apply(this,arguments)}function O(){return(O=Object(b.a)(u.a.mark((function e(){var t,n,r,o,s,c,a,i=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=i.length,n=new Array(t),r=0;r<t;r++)n[r]=i[r];if(o=n[1],s=n[2],o){e.next=4;break}return e.abrupt("return",{content:"",updatedAt:new Date});case 4:return c="".concat(f,"/report/").concat(o),a={method:"GET",headers:{Authorization:s||""}},e.abrupt("return",fetch(c,a).then((function(e){return e.json()})).then((function(e){return e.data})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v,y=Object(r.createContext)({loginUser:function(e){},logoutUser:function(){},isLoggedIn:!1,token:null});function w(){return Object(r.useContext)(y)}!function(e){e[e.PENDING=0]="PENDING",e[e.ACCEPTED=1]="ACCEPTED",e[e.APPROVED=2]="APPROVED",e[e.REJECTED=3]="REJECTED"}(v||(v={}));var N=function(e){switch(e){case v.ACCEPTED:return"Accepted";case v.APPROVED:return"Approved";case v.REJECTED:return"Rejected";case v.PENDING:default:return"Pending"}},E=n(0),C=function(e){var t=e.id,n=e.date,r=e.username,o=e.status,s=e.content;return Object(E.jsx)(i.b,{to:"/entry/".concat(t),className:"max-w-screen-sm w-full",children:Object(E.jsxs)("div",{className:"bg-gray-50 px-4 py-3 mx-4 my-2 hover:bg-gray-200 rounded-md shadow",children:[Object(E.jsxs)("div",{className:"flex border-b border-gray-200 mb-1 pb-2",children:[Object(E.jsxs)("div",{className:"flex-1 flex items-start flex-col",children:[Object(E.jsx)("div",{className:"font-medium text-black",children:n.toDateString()}),Object(E.jsxs)("div",{children:["Created by: ",r]})]}),Object(E.jsx)("div",{className:"ml-4 flex items-start justify-center font-bold",children:N(o)})]}),Object(E.jsx)("p",{className:"h-12 max-w-full overflow-ellipsis text-left overflow-hidden",children:s})]})})},S=function(){var e=w().token,t=Object(d.b)(["report/",e],x),n=t.data,r=t.error;return Object(E.jsxs)("div",{className:"h-screen",children:[Object(E.jsx)("div",{className:"flex justify-end mt-2",children:Object(E.jsx)(i.b,{to:"/entry/create",className:"btn-blue px-3 py-2 m-2 bg-green-600 rounded text-white text-sm",children:"Create New Report"})}),Object(E.jsx)("div",{className:"flex flex-col items-center",children:r?Object(E.jsx)("div",{children:"Error loading"}):null===n||void 0===n?void 0:n.map((function(e,t){return Object(E.jsx)(C,{id:e.id,date:e.updatedAt,username:e.username,status:e.status,content:e.content},t)}))})]})},P=n(12),T=n(6),A=m.apiUrl;var I,D=function(){var e=Object(r.useState)({email:void 0,password:void 0}),t=Object(T.a)(e,2),n=t[0],o=t[1],s=Object(r.useState)(!1),c=Object(T.a)(s,2),i=c[0],d=c[1],l=w().loginUser,u=Object(a.g)(),b=function(e){var t=e.target,r=t.name,s=t.value;o(Object(j.a)(Object(j.a)({},n),{},Object(P.a)({},r,s)))};return Object(E.jsx)("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:Object(E.jsxs)("div",{className:"max-w-sm w-full space-y-8",children:[Object(E.jsx)("div",{children:Object(E.jsx)("h3",{className:"font-bold text-2xl uppercase",children:"Report System"})}),Object(E.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:function(e){e.preventDefault(),d(!0),function(e,t){var n="".concat(A,"/user/login"),r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})};return fetch(n,r).then((function(e){return e.json()}))}(n.email,n.password).then((function(e){console.log(e),d(!1),l(e.token),u.push("/")}))},children:[Object(E.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),Object(E.jsx)("input",{name:"email",type:"email",autoComplete:"email",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",required:!0,onChange:b})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),Object(E.jsx)("input",{name:"password",type:"password",autoComplete:"current-password",placeholder:"Password",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",required:!0,onChange:b})]})]}),Object(E.jsx)("div",{children:Object(E.jsx)("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:i?"Loading...":"Login"})}),Object(E.jsx)("div",{children:Object(E.jsxs)("div",{className:"text-sm",children:["No account? Click",Object(E.jsx)("a",{href:"signup",className:"px-1 font-bold lg:hover:underline",children:"here"}),"to sign up!"]})})]})]})})},k=function(){var e=Object(r.useState)({email:void 0,password:void 0}),t=Object(T.a)(e,2),n=t[0],o=t[1],s=Object(r.useState)(!1),c=Object(T.a)(s,2),i=c[0],d=c[1],l=w().loginUser,u=Object(a.g)(),b=function(e){var t=e.target,r=t.name,s=t.value;o(Object(j.a)(Object(j.a)({},n),{},Object(P.a)({},r,s)))};return Object(E.jsx)("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:Object(E.jsxs)("div",{className:"max-w-sm w-full space-y-8",children:[Object(E.jsx)("div",{className:"text-center",children:Object(E.jsx)("h3",{className:"font-bold text-2xl uppercase",children:"Sign Up"})}),Object(E.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:function(e){e.preventDefault(),d(!0),console.log(n),n.confirmedPassword===n.password?(console.log("here"),function(e,t,n){var r="".concat(A,"/user/signup"),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,username:n})};return fetch(r,o).then((function(e){return e.json()}))}(n.email,n.password,n.username).then((function(e){console.log(e),l(e.token),d(!1),u.push("/")}))):d(!1)},children:[Object(E.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),Object(E.jsx)("input",{name:"email",type:"email",autoComplete:"email",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 rounded-t-md text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",required:!0,onChange:b})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Username"}),Object(E.jsx)("input",{name:"username",type:"name",autoComplete:"username",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Username",required:!0,onChange:b})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),Object(E.jsx)("input",{name:"password",type:"password",placeholder:"Password",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",required:!0,onChange:b})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Confirm Password"}),Object(E.jsx)("input",{name:"confirmedPassword",type:"password",placeholder:"Confirm password",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 rounded-b-md text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",required:!0,onChange:b})]})]}),Object(E.jsx)("div",{children:Object(E.jsx)("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:i?"Loading...":"Sign Up"})})]})]})})};!function(e){e[e.VIEW=0]="VIEW",e[e.CREATE=1]="CREATE",e[e.EDIT=2]="EDIT"}(I||(I={}));var R,U=m.apiUrl;function L(e){return fetch(U+"/user/info",{method:"GET",headers:{"Content-Type":"application/json",Authorization:e}}).then((function(e){return e.json()})).then((function(e){return e.user}))}!function(e){e[e.ADMIN=0]="ADMIN",e[e.USER=1]="USER"}(R||(R={}));var F=function(e){var t,n=e.mode,o=void 0===n?I.VIEW:n,s=e.id,c=Object(r.useState)(o),i=Object(T.a)(c,2),l=i[0],u=i[1],b=Object(a.g)(),m=w().token,f=function(){var e=w().token,t=Object(r.useState)(null),n=Object(T.a)(t,2),o=n[0],s=n[1],c=Object(d.b)(e,L,{refreshInterval:0}),a=c.data,i=c.mutate,l=c.error;return Object(r.useEffect)((function(){a&&s(a),l&&s(null)}),[a,l]),{user:o,mutate:i}}().user,x=Object(d.b)(["/report/id",s,m],g,{errorRetryCount:0,refreshInterval:0}),O=x.data,y=x.mutate;return x.error?Object(E.jsx)("div",{className:"flex justify-center items-center",children:"Failed to load, please refresh"}):Object(E.jsx)("div",{className:"flex justify-center items-center",children:Object(E.jsxs)("div",{className:"max-w-screen-sm w-full px-3",children:[Object(E.jsxs)("div",{className:"flex justify-between mt-6 mb-3",children:[Object(E.jsx)("h1",{className:"font-bold text-2xl",children:"Report"}),(null===O||void 0===O?void 0:O.status)===v.PENDING&&(null===f||void 0===f?void 0:f.role)===R.ADMIN?Object(E.jsxs)("div",{children:[Object(E.jsx)("button",{onClick:function(){l===I.VIEW?u(I.EDIT):u(I.VIEW)},className:"my-2 mx-3 py-1 px-6 border border-transparent text-sm font-medium rounded-md text-white bg-blue-500 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Edit"}),Object(E.jsx)("button",{onClick:function(){O&&m&&h(Object(j.a)(Object(j.a)({},O),{},{status:v.APPROVED}),m).then((function(e){y(Object(j.a)({},e)),u(I.VIEW)}))},className:"my-2 py-1 px-6 border border-transparent text-sm font-medium rounded-md text-white bg-green-500 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Approve"})]}):null]}),Object(E.jsxs)("div",{children:["Date: ",(null===O||void 0===O?void 0:O.updatedAt)?null===O||void 0===O||null===(t=O.updatedAt)||void 0===t?void 0:t.toLocaleString():(new Date).toLocaleString()]}),Object(E.jsxs)("div",{children:["Edit By: ",(null===O||void 0===O?void 0:O.username)?null===O||void 0===O?void 0:O.username:null===f||void 0===f?void 0:f.username]}),Object(E.jsx)("div",{className:"w-full mt-4",children:l===I.VIEW?Object(E.jsx)("div",{children:null===O||void 0===O?void 0:O.content}):Object(E.jsxs)("div",{children:[Object(E.jsx)("div",{children:Object(E.jsx)("textarea",{className:"w-full",value:null===O||void 0===O?void 0:O.content,onChange:function(e){O&&y(Object(j.a)(Object(j.a)({},O),{},{content:e.target.value}),!1)}})}),Object(E.jsx)("div",{className:"w-full flex justify-center",children:Object(E.jsx)("button",{onClick:function(){console.log("submitReport",O,l),m&&O&&(l===I.CREATE&&function(e,t){return p.apply(this,arguments)}(O,m).then((function(e){b.push("/entry/".concat(e.id))})),l===I.EDIT&&h(O,m).then((function(e){y(Object(j.a)({},e),!1),u(I.VIEW)})))},className:"my-2 py-1 px-6 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Save"})})]})})]})})},V=function(e){var t=Object(a.h)().id;return Object(E.jsx)(F,Object(j.a)(Object(j.a)({},e),{},{mode:I.VIEW,id:t}))},W=function(e){return w().isLoggedIn?Object(E.jsx)(a.b,Object(j.a)(Object(j.a)({},e),{},{component:e.component})):Object(E.jsx)(a.a,{to:"/login"})},z=function(){var e=w(),t=e.isLoggedIn,n=e.logoutUser,o=Object(a.g)();return t?Object(E.jsxs)("nav",{className:"flex max-w-full h-12 shadow-sm justify-between items-center bg-gray-200",children:[Object(E.jsx)("div",{children:Object(E.jsx)(i.b,{to:"/",children:Object(E.jsx)("h3",{className:"mx-4 font-bold text-lg",children:"Report System"})})}),Object(E.jsx)("div",{className:"flex",children:Object(E.jsx)("div",{className:"mx-2",children:Object(E.jsx)("button",{onClick:function(){n(),d.a.clear(),o.push("/login",{})},className:"bg-gray-500 px-5 py-1 rounded-md text-white",children:"Logout"})})})]}):Object(E.jsx)(r.Fragment,{})};var _=function(){var e=function(){var e=Object(r.useState)(localStorage.getItem("token")),t=Object(T.a)(e,2),n=t[0],o=t[1],s=Object(r.useState)(!!localStorage.getItem("token")),c=Object(T.a)(s,2),a=c[0],i=c[1];return{loginUser:function(e){localStorage.setItem("token",e),o(e),i(!0)},logoutUser:function(){localStorage.removeItem("token"),o(null),i(!1)},isLoggedIn:a,token:n}}();return Object(E.jsx)(y.Provider,{value:e,children:Object(E.jsxs)("div",{className:"bg-gray-100 h-screen",children:[Object(E.jsx)(z,{}),Object(E.jsxs)(a.d,{children:[Object(E.jsx)(W,{exact:!0,path:"/",children:Object(E.jsx)(S,{})}),Object(E.jsx)(W,{exact:!0,path:"/entry/create",children:Object(E.jsx)(F,{mode:I.CREATE})}),Object(E.jsx)(W,{path:"/entry/:id",children:Object(E.jsx)(V,{})}),Object(E.jsx)(a.b,{path:"/login",children:Object(E.jsx)(D,{})}),Object(E.jsx)(a.b,{path:"/signup",children:Object(E.jsx)(k,{})}),Object(E.jsx)(a.b,{path:"*",children:"Page not found :("})]})]})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),s(e),c(e)}))};c.a.render(Object(E.jsx)(o.a.StrictMode,{children:Object(E.jsx)(i.a,{children:Object(E.jsx)(_,{})})}),document.getElementById("root")),J()}},[[36,1,2]]]);
//# sourceMappingURL=main.b0037149.chunk.js.map